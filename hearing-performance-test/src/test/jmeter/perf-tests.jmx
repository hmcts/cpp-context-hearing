<?xml version="1.0" encoding="UTF-8"?>
<jmeterTestPlan version="1.2" properties="5.0" jmeter="5.6.3">
  <hashTree>
    <TestPlan guiclass="TestPlanGui" testclass="TestPlan" testname="Test Plan">
      <elementProp name="TestPlan.user_defined_variables" elementType="Arguments" guiclass="ArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
        <collectionProp name="Arguments.arguments">
          <elementProp name="numberOfThreads" elementType="Argument">
            <stringProp name="Argument.name">numberOfThreads</stringProp>
            <stringProp name="Argument.value">${__P(jmeter.usersgroups.numberOfThreads, 1)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="loopCount" elementType="Argument">
            <stringProp name="Argument.name">loopCount</stringProp>
            <stringProp name="Argument.value">${__P(jmeter.usersgroups.loopCount, 1)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="rampUpPeriod" elementType="Argument">
            <stringProp name="Argument.name">rampUpPeriod</stringProp>
            <stringProp name="Argument.value">${__P(jmeter.usersgroups.rampUpPeriod, 1)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="protocol" elementType="Argument">
            <stringProp name="Argument.name">protocol</stringProp>
            <stringProp name="Argument.value">${__P(jmeter.usersgroups.protocol, http)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="hostName" elementType="Argument">
            <stringProp name="Argument.name">hostName</stringProp>
            <stringProp name="Argument.value">${__P(jmeter.usersgroups.hostName, localhost)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="port" elementType="Argument">
            <stringProp name="Argument.name">port</stringProp>
            <stringProp name="Argument.value">${__P(jmeter.usersgroups.port, 8080)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="userId" elementType="Argument">
            <stringProp name="Argument.name">userId</stringProp>
            <stringProp name="Argument.value">${__P(jmeter.usersgroups.userId, 7a04cabb-102a-4737-9ae1-a703dcf62cff)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="dbHost" elementType="Argument">
            <stringProp name="Argument.name">dbHost</stringProp>
            <stringProp name="Argument.value">${__P(jmeter.usersgroups.dbHost, localhost)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="dbPort" elementType="Argument">
            <stringProp name="Argument.name">dbPort</stringProp>
            <stringProp name="Argument.value">${__P(jmeter.usersgroups.dbPort, 5432)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="dbUserName" elementType="Argument">
            <stringProp name="Argument.name">dbUserName</stringProp>
            <stringProp name="Argument.value">${__P(jmeter.usersgroups.dbUserName, postgres)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="dbPassword" elementType="Argument">
            <stringProp name="Argument.name">dbPassword</stringProp>
            <stringProp name="Argument.value">${__P(jmeter.usersgroups.dbPassword, postgres)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="metricsIntervalInMs" elementType="Argument">
            <stringProp name="Argument.name">metricsIntervalInMs</stringProp>
            <stringProp name="Argument.value">${__P(jmeter.usersgroups.metricsIntervalInMs, 10000)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="resultDir" elementType="Argument">
            <stringProp name="Argument.name">resultDir</stringProp>
            <stringProp name="Argument.value">${__P(jmeter.usersgroups.resultDir)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="pollerTimeout" elementType="Argument">
            <stringProp name="Argument.name">pollerTimeout</stringProp>
            <stringProp name="Argument.value">${__P(jmeter.usersgroups.pollerTimeout, 10000)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="pollInterval" elementType="Argument">
            <stringProp name="Argument.name">pollInterval</stringProp>
            <stringProp name="Argument.value">${__P(jmeter.usersgroups.pollInterval, 100)}</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
        </collectionProp>
      </elementProp>
      <boolProp name="TestPlan.functional_mode">false</boolProp>
      <boolProp name="TestPlan.serialize_threadgroups">false</boolProp>
    </TestPlan>
    <hashTree>
      <JDBCDataSource guiclass="TestBeanGUI" testclass="JDBCDataSource" testname="ViewStoreJDBCConfig">
        <boolProp name="autocommit">true</boolProp>
        <stringProp name="checkQuery"></stringProp>
        <stringProp name="connectionAge">5000</stringProp>
        <stringProp name="connectionProperties"></stringProp>
        <stringProp name="dataSource">hearingviewstore</stringProp>
        <stringProp name="dbUrl">jdbc:postgresql://${dbHost}:${dbPort}/usersgroupsviewstore</stringProp>
        <stringProp name="driver">org.postgresql.Driver</stringProp>
        <stringProp name="initQuery"></stringProp>
        <boolProp name="keepAlive">true</boolProp>
        <stringProp name="password">${dbPassword}</stringProp>
        <stringProp name="poolMax">0</stringProp>
        <boolProp name="preinit">false</boolProp>
        <stringProp name="timeout">10000</stringProp>
        <stringProp name="transactionIsolation">DEFAULT</stringProp>
        <stringProp name="trimInterval">60000</stringProp>
        <stringProp name="username">${dbUserName}</stringProp>
      </JDBCDataSource>
      <hashTree/>
      <JDBCDataSource guiclass="TestBeanGUI" testclass="JDBCDataSource" testname="EventStoreJDBCConfig" enabled="true">
        <boolProp name="autocommit">true</boolProp>
        <stringProp name="checkQuery"></stringProp>
        <stringProp name="connectionAge">5000</stringProp>
        <stringProp name="connectionProperties"></stringProp>
        <stringProp name="dataSource">hearingseventstore</stringProp>
        <stringProp name="dbUrl">jdbc:postgresql://${dbHost}:${dbPort}/usersgroupseventstore</stringProp>
        <stringProp name="driver">org.postgresql.Driver</stringProp>
        <stringProp name="initQuery"></stringProp>
        <boolProp name="keepAlive">true</boolProp>
        <stringProp name="password">${dbPassword}</stringProp>
        <stringProp name="poolMax">0</stringProp>
        <boolProp name="preinit">false</boolProp>
        <stringProp name="timeout">10000</stringProp>
        <stringProp name="transactionIsolation">DEFAULT</stringProp>
        <stringProp name="trimInterval">60000</stringProp>
        <stringProp name="username">${dbUserName}</stringProp>
      </JDBCDataSource>
      <hashTree/>
      <SetupThreadGroup guiclass="SetupThreadGroupGui" testclass="SetupThreadGroup" testname="setUp Thread Group">
        <intProp name="ThreadGroup.num_threads">1</intProp>
        <intProp name="ThreadGroup.ramp_time">1</intProp>
        <boolProp name="ThreadGroup.same_user_on_next_iteration">true</boolProp>
        <stringProp name="ThreadGroup.on_sample_error">continue</stringProp>
        <elementProp name="ThreadGroup.main_controller" elementType="LoopController" guiclass="LoopControlPanel" testclass="LoopController" testname="Loop Controller">
          <stringProp name="LoopController.loops">1</stringProp>
          <boolProp name="LoopController.continue_forever">false</boolProp>
        </elementProp>
      </SetupThreadGroup>
      <hashTree>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockReset">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    WireMock.reset()
    
    log.info(&quot;WireMock reset completed successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to reset WireMock: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubOrganisationUnit">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    String courtCentreId = &quot;b52f805c-2821-4904-a0e0-26f7fda6dd08&quot;
    String organisationUnitUrl = &quot;/referencedata-service/query/api/rest/referencedata/organisation-units/&quot; + courtCentreId
    String mediaType = &quot;application/vnd.referencedata.query.organisation-unit.v2+json&quot;
    
    // Organisation unit response matching the stub data structure with EnforcementArea

	String organisationUnitJson = &quot;{\&quot;address1\&quot;:\&quot;address 1\&quot;,\&quot;enforcementArea\&quot;:{\&quot;bankAccntName\&quot;:\&quot;account name\&quot;,\&quot;bankAccntNum\&quot;:1,\&quot;bankAccntSortCode\&quot;:\&quot;867878\&quot;,\&quot;bankAddressLine1\&quot;:\&quot;address1\&quot;,\&quot;remittanceAdviceEmailAddress\&quot;:\&quot;test@test.com\&quot;,\&quot;additionalProperties\&quot;:{}},\&quot;id\&quot;:\&quot;b52f805c-2821-4904-a0e0-26f7fda6dd08\&quot;,\&quot;isWelsh\&quot;:true,\&quot;lja\&quot;:\&quot;2745\&quot;,\&quot;oucode\&quot;:\&quot;2745\&quot;,\&quot;oucodeL3Name\&quot;:\&quot;hfn56ie1jR\&quot;,\&quot;oucodeL3WelshName\&quot;:\&quot;hfn56ie1jR\&quot;,\&quot;postcode\&quot;:\&quot;AL4 9LG\&quot;,\&quot;welshAddress1\&quot;:\&quot;Welsh address1\&quot;,\&quot;welshAddress2\&quot;:\&quot;Welsh address2\&quot;,\&quot;welshAddress3\&quot;:\&quot;Welsh address3\&quot;,\&quot;welshAddress4\&quot;:\&quot;Welsh address5\&quot;}&quot;

    
    stubFor(get(urlPathEqualTo(organisationUnitUrl))
            .withHeader(&quot;Accept&quot;, equalTo(mediaType))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, mediaType)
                    .withBody(organisationUnitJson)))
    
    log.info(&quot;WireMock stub for organisation unit configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub for organisation unit: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubEnforcementArea">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    String enforcementAreaUrl = &quot;/referencedata-service/query/api/rest/referencedata/enforcement-area&quot;
    String mediaType = &quot;application/vnd.referencedata.query.enforcement-area+json&quot;
    
    // Enforcement area response matching the structure from integration tests
    String enforcementAreaJson = &quot;{\&quot;accountDivisionCode\&quot;:5673,\&quot;address1\&quot;:\&quot;address1 2745\&quot;,\&quot;address2\&quot;:\&quot;address2 2745\&quot;,\&quot;address3\&quot;:\&quot;address3 2745\&quot;,\&quot;address4\&quot;:\&quot;address4 2745\&quot;,\&quot;email\&quot;:\&quot;enforcement2745@gov.com\&quot;,\&quot;localJusticeArea\&quot;:{\&quot;name\&quot;:\&quot;ljaName2745\&quot;,\&quot;nationalCourtCode\&quot;:\&quot;123\&quot;,\&quot;additionalProperties\&quot;:{}},\&quot;nationalPaymentPhone\&quot;:\&quot;12344566\&quot;,\&quot;phone\&quot;:\&quot;123456789\&quot;,\&quot;postcode\&quot;:\&quot;AL4 9LG\&quot;,\&quot;additionalProperties\&quot;:{}}&quot;
    
    // Stub for any localJusticeAreaNationalCourtCode query parameter
    stubFor(get(urlPathEqualTo(enforcementAreaUrl))
            .withQueryParam(&quot;localJusticeAreaNationalCourtCode&quot;, matching(&quot;.*&quot;))
            .withHeader(&quot;Accept&quot;, equalTo(mediaType))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, mediaType)
                    .withBody(enforcementAreaJson)))
    
    log.info(&quot;WireMock stub for enforcement area configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub for enforcement area: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubUserPermissions">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    // Get userId from JMeter variables (defaults to the one from user defined variables)
    String userId = vars.get(&quot;userId&quot;)
    if (userId == null || userId.isEmpty()) {
        userId = &quot;7a04cabb-102a-4737-9ae1-a703dcf62cff&quot;
    }
    
    // stubUsersAndGroupsGetLoggedInPermissionsWithoutCases
    String permissionsUrl = &quot;/usersgroups-service/query/api/rest/usersgroups/users/logged-in-user/permissions&quot;
    String permissionsJson = &quot;{\&quot;groups\&quot;:[{\&quot;groupId\&quot;:\&quot;7e2f843e-d639-40b3-8611-8015f3a13333\&quot;,\&quot;groupName\&quot;:\&quot;groupName1\&quot;,\&quot;prosecutingAuthority\&quot;:\&quot;TFL\&quot;},{\&quot;groupId\&quot;:\&quot;7e2f843e-d639-40b3-8611-8015f3a13334\&quot;,\&quot;groupName\&quot;:\&quot;groupName2\&quot;,\&quot;prosecutingAuthority\&quot;:\&quot;TVL\&quot;}],\&quot;permissions\&quot;:[{\&quot;action\&quot;:\&quot;groupName1\&quot;,\&quot;object\&quot;:\&quot;TFL\&quot;,\&quot;source\&quot;:\&quot;7e2f843e-d639-40b3-8611-8015f3a13333\&quot;,\&quot;target\&quot;:\&quot;7e2f843e-d639-40b3-8611-8015f3a13334\&quot;},{\&quot;action\&quot;:\&quot;groupName2\&quot;,\&quot;object\&quot;:\&quot;TVL\&quot;,\&quot;source\&quot;:\&quot;7e2f843e-d639-40b3-8611-8015f3a13333\&quot;,\&quot;target\&quot;:\&quot;7e2f843e-d639-40b3-8611-8015f3a13334\&quot;}],\&quot;switchableRoles\&quot;:[{\&quot;roleId\&quot;:\&quot;7e2f843e-d639-40b3-8611-8015f3a13333\&quot;,\&quot;description\&quot;:\&quot;description1\&quot;,\&quot;label\&quot;:\&quot;label1\&quot;,\&quot;selectable\&quot;:true},{\&quot;roleId\&quot;:\&quot;7e2f843e-d639-40b3-8611-8015f3a13334\&quot;,\&quot;description\&quot;:\&quot;description2\&quot;,\&quot;label\&quot;:\&quot;label2\&quot;,\&quot;selectable\&quot;:false}]}&quot;
    
    stubFor(get(urlPathEqualTo(permissionsUrl))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, &quot;application/json&quot;)
                    .withBody(permissionsJson)))
    
    // stubUsersAndGroupsUserRoles
    String rolesUrl = &quot;/usersgroups-service/query/api/rest/usersgroups/users/&quot; + userId + &quot;/roles&quot;
    String rolesJson = &quot;{\&quot;groups\&quot;:[{\&quot;groupId\&quot;:\&quot;1e2f843e-d639-40b3-8611-8015f3a18958\&quot;},{\&quot;groupId\&quot;:\&quot;1e2f843e-d639-40b3-8211-8015f3a18958\&quot;}],\&quot;allRoles\&quot;:[{\&quot;roleId\&quot;:\&quot;1e2f843e-d649-40b3-8611-8015f3a18952\&quot;,\&quot;label\&quot;:\&quot;role label\&quot;,\&quot;description\&quot;:\&quot;role description\&quot;,\&quot;selectable\&quot;:true,\&quot;startDate\&quot;:null,\&quot;endDate\&quot;:null}]}&quot;
    
    stubFor(get(urlPathEqualTo(rolesUrl))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, &quot;application/json&quot;)
                    .withBody(rolesJson)))
    
    // setupAsAuthorisedUser and setupAsSystemUser
    String groupsUrl = &quot;/usersgroups-service/query/api/rest/usersgroups/users/&quot; + userId + &quot;/groups&quot;
    String groupsJson = &quot;{\&quot;groups\&quot;:[{\&quot;groupId\&quot;:\&quot;7e2f143e-d619-40b3-8611-8015f3a18957\&quot;,\&quot;groupName\&quot;:\&quot;Court Clerks\&quot;}, {\&quot;groupId\&quot;:\&quot;14986cb7-eefa-48b3-b7e2-34431c3265e5\&quot;,\&quot;groupName\&quot;:\&quot;System Users\&quot;}]}&quot;
    

    stubFor(get(urlPathEqualTo(groupsUrl))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, userId)
                    .withHeader(&quot;Content-Type&quot;, &quot;application/json&quot;)
                    .withBody(groupsJson)))
                    
    String groupsUrl2 = &quot;/usersgroups-service/query/api/rest/usersgroups/users/46986cb7-eefa-48b3-b7e2-34431c3265e5/groups&quot;
    String groupsJson2 = &quot;{\&quot;groups\&quot;:[{\&quot;groupId\&quot;:\&quot;14986cb7-eefa-48b3-b7e2-34431c3265e5\&quot;,\&quot;groupName\&quot;:\&quot;System Users\&quot;}]}&quot;
   
    stubFor(get(urlPathEqualTo(groupsUrl2))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, &quot;46986cb7-eefa-48b3-b7e2-34431c3265e5&quot;)
                    .withHeader(&quot;Content-Type&quot;, &quot;application/json&quot;)
                    .withBody(groupsJson2)))

    
    // stubUserGroupLoggedInUserHasPermissionForObject
    stubFor(get(urlMatching(&quot;/usersgroups-service/query/api/rest/usersgroups/users/logged-in-user/permissions.*&quot;))
            .atPriority(1)
            .withHeader(&quot;Accept&quot;, containing(&quot;application/vnd.usersgroups.is-logged-in-user-has-permission-for-object+json&quot;))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, &quot;application/json&quot;)
                    .withBody(&quot;{\&quot;hasPermission\&quot;:true}&quot;)))
    
    // stubUserGroupLoggedInUserHasPermissionForAction
    stubFor(get(urlMatching(&quot;/usersgroups-service/query/api/rest/usersgroups/users/logged-in-user/permissions.*&quot;))
            .atPriority(1)
            .withHeader(&quot;Accept&quot;, containing(&quot;application/vnd.usersgroups.is-logged-in-user-has-permission-for-action+json&quot;))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, &quot;application/json&quot;)
                    .withBody(&quot;{\&quot;permissions\&quot;:[]}&quot;)))
    
    log.info(&quot;WireMock stubs for user permissions, roles, groups, and permission checks configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stubs: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubPleaTypes" enabled="true">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    // stubPleaTypeGuiltyFlags
    String pleaTypesUrl = &quot;/referencedata-service/query/api/rest/referencedata/plea-types&quot;
    String pleaTypesMediaType = &quot;application/vnd.referencedata.plea-types+json&quot;
    String pleaTypesJson = &quot;{\&quot;pleaStatusTypes\&quot;:[{\&quot;sequence\&quot;:20,\&quot;pleaTypeCode\&quot;:\&quot;G\&quot;,\&quot;pleaTypeUIFlag\&quot;:true,\&quot;pleaTypeDescription\&quot;:\&quot;Guilty\&quot;,\&quot;pleaTypeGuiltyFlag\&quot;:\&quot;Yes\&quot;,\&quot;pleaTypeCivilFlag\&quot;:\&quot;No\&quot;,\&quot;pleaStatusCode\&quot;:\&quot;1\&quot;,\&quot;pleaValue\&quot;:\&quot;GUILTY\&quot;,\&quot;jurisdiction\&quot;:\&quot;EITHER\&quot;},{\&quot;sequence\&quot;:40,\&quot;pleaTypeCode\&quot;:\&quot;GSJP\&quot;,\&quot;pleaTypeUIFlag\&quot;:true,\&quot;pleaTypeDescription\&quot;:\&quot;Guilty Single Justice Procedure\&quot;,\&quot;pleaTypeGuiltyFlag\&quot;:\&quot;Yes\&quot;,\&quot;pleaTypeCivilFlag\&quot;:\&quot;No\&quot;,\&quot;pleaStatusCode\&quot;:\&quot;6\&quot;,\&quot;pleaValue\&quot;:\&quot;GUILTY_SINGLE_JUSTICE_PROCEDURE\&quot;,\&quot;jurisdiction\&quot;:\&quot;MAGISTRATES\&quot;},{\&quot;sequence\&quot;:50,\&quot;pleaTypeCode\&quot;:\&quot;IG\&quot;,\&quot;pleaTypeUIFlag\&quot;:true,\&quot;pleaTypeDescription\&quot;:\&quot;Indicated plea of Guilty\&quot;,\&quot;pleaTypeGuiltyFlag\&quot;:\&quot;Yes\&quot;,\&quot;pleaTypeCivilFlag\&quot;:\&quot;No\&quot;,\&quot;pleaStatusCode\&quot;:\&quot;1\&quot;,\&quot;pleaValue\&quot;:\&quot;INDICATED_GUILTY\&quot;,\&quot;jurisdiction\&quot;:\&quot;MAGISTRATES\&quot;},{\&quot;sequence\&quot;:60,\&quot;pleaTypeCode\&quot;:\&quot;ADB\&quot;,\&quot;pleaTypeUIFlag\&quot;:false,\&quot;pleaTypeDescription\&quot;:\&quot;Admits Breach\&quot;,\&quot;pleaTypeGuiltyFlag\&quot;:\&quot;Yes\&quot;,\&quot;pleaTypeCivilFlag\&quot;:\&quot;No\&quot;,\&quot;pleaStatusCode\&quot;:\&quot;1\&quot;,\&quot;pleaValue\&quot;:\&quot;ADMITS_BREACH\&quot;,\&quot;jurisdiction\&quot;:\&quot;MAGISTRATES\&quot;},{\&quot;sequence\&quot;:70,\&quot;pleaTypeCode\&quot;:\&quot;NG\&quot;,\&quot;pleaTypeUIFlag\&quot;:true,\&quot;pleaTypeDescription\&quot;:\&quot;Not Guilty\&quot;,\&quot;pleaTypeGuiltyFlag\&quot;:\&quot;No\&quot;,\&quot;pleaTypeCivilFlag\&quot;:\&quot;No\&quot;,\&quot;pleaStatusCode\&quot;:\&quot;2\&quot;,\&quot;pleaValue\&quot;:\&quot;NOT_GUILTY\&quot;,\&quot;jurisdiction\&quot;:\&quot;EITHER\&quot;},{\&quot;sequence\&quot;:80,\&quot;pleaTypeCode\&quot;:\&quot;UNFIT\&quot;,\&quot;pleaTypeUIFlag\&quot;:true,\&quot;pleaTypeDescription\&quot;:\&quot;Unfit to Plead\&quot;,\&quot;pleaTypeGuiltyFlag\&quot;:\&quot;No\&quot;,\&quot;pleaTypeCivilFlag\&quot;:\&quot;No\&quot;,\&quot;pleaStatusCode\&quot;:\&quot;3\&quot;,\&quot;pleaValue\&quot;:\&quot;UNFIT_TO_PLEAD\&quot;,\&quot;jurisdiction\&quot;:\&quot;MAGISTRATES\&quot;},{\&quot;sequence\&quot;:130,\&quot;pleaTypeCode\&quot;:\&quot;CON\&quot;,\&quot;pleaTypeUIFlag\&quot;:false,\&quot;pleaTypeDescription\&quot;:\&quot;Consents\&quot;,\&quot;pleaTypeGuiltyFlag\&quot;:\&quot;Yes\&quot;,\&quot;pleaTypeCivilFlag\&quot;:\&quot;Yes\&quot;,\&quot;pleaStatusCode\&quot;:\&quot;7\&quot;,\&quot;pleaValue\&quot;:\&quot;CONSENTS\&quot;,\&quot;jurisdiction\&quot;:\&quot;MAGISTRATES\&quot;}]}&quot;
    
    stubFor(get(urlPathMatching(pleaTypesUrl))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, pleaTypesMediaType)
                    .withBody(pleaTypesJson)))
    
    log.info(&quot;WireMock stub for plea types configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub for plea types: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubProsecutor">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    // Stub prosecutor for any prosecutionAuthorityId
    // The prosecutor ID comes from prosecutionAuthorityId in the test data
    String prosecutorMediaType = &quot;application/vnd.referencedata.query.get-prosecutor+json&quot;
    
    // Stub for any prosecutor ID - use urlPathMatching to extract the ID dynamically
    stubFor(get(urlMatching(&quot;/referencedata-service/query/api/rest/referencedata/prosecutors/[a-f0-9\\-]+&quot;))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, prosecutorMediaType)
                    .withBody(&quot;{\&quot;id\&quot;:\&quot;406a61c5-4d71-4a81-82e4-16e7234424dd\&quot;,\&quot;fullName\&quot;:\&quot;Prosecutor Name\&quot;,\&quot;oucode\&quot;:\&quot;OuCode\&quot;,\&quot;majorCreditorCode\&quot;:\&quot;Major creditor code\&quot;,\&quot;address\&quot;:{\&quot;address1\&quot;:\&quot;Address1\&quot;,\&quot;postcode\&quot;:\&quot;NU44 3XQ\&quot;},\&quot;informantEmailAddress\&quot;:\&quot;dummy@email.com\&quot;}&quot;)))
    
    log.info(&quot;WireMock stub for prosecutor configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub for prosecutor: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubLocalJusticeAreas" enabled="true">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    // Stub local justice areas
    String localJusticeAreasUrl = &quot;/referencedata-service/query/api/rest/referencedata/local-justice-areas&quot;
    String localJusticeAreasMediaType = &quot;application/vnd.referencedata.query.local-justice-areas+json&quot;
    String localJusticeAreasJson = &quot;{\&quot;localJusticeAreas\&quot;:[{\&quot;nationalCourtCode\&quot;:\&quot;123\&quot;,\&quot;name\&quot;:\&quot;Test LJA\&quot;,\&quot;welshName\&quot;:\&quot;testetestetes\&quot;}]}&quot;
    
    // Stub for any nationalCourtCode query parameter
    stubFor(get(urlPathEqualTo(localJusticeAreasUrl))
            .withQueryParam(&quot;nationalCourtCode&quot;, matching(&quot;.*&quot;))
            .withHeader(&quot;Accept&quot;, equalTo(localJusticeAreasMediaType))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, localJusticeAreasMediaType)
                    .withBody(localJusticeAreasJson)))
    
    log.info(&quot;WireMock stub for local justice areas configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub for local justice areas: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubNowsMetadata">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID
import java.time.LocalDate

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    // Stub nows metadata
    String nowsMetadataUrl = &quot;/referencedata-service/query/api/rest/referencedata/nows-metadata&quot;
    String nowsMetadataMediaType = &quot;application/vnd.referencedata.get-all-now-metadata+json&quot;
    
    // Minimal nows metadata response matching the structure from integration tests
    String nowId1 = UUID.randomUUID().toString()
    String nowId2 = &quot;10115268-8efc-49fe-b8e8-feee216a03da&quot;
    String resultDefId1 = UUID.randomUUID().toString()
    String resultDefId2 = UUID.randomUUID().toString()
    String resultDefId3 = &quot;de946ddc-ad77-44b1-8480-8bbc251cdcfb&quot;
    String nowsMetadataJson = &quot;{\&quot;nows\&quot;:[{\&quot;id\&quot;:\&quot;&quot; + nowId1 + &quot;\&quot;,\&quot;name\&quot;:\&quot;Test Now\&quot;,\&quot;text\&quot;:\&quot;NowLevel/Test\&quot;,\&quot;templateName\&quot;:\&quot;TestTemplate\&quot;,\&quot;rank\&quot;:1,\&quot;jurisdiction\&quot;:\&quot;B\&quot;,\&quot;remotePrintingRequired\&quot;:false,\&quot;resultDefinitions\&quot;:[{\&quot;id\&quot;:\&quot;&quot; + resultDefId1 + &quot;\&quot;,\&quot;mandatory\&quot;:true,\&quot;primary\&quot;:true},{\&quot;id\&quot;:\&quot;&quot; + resultDefId2 + &quot;\&quot;,\&quot;mandatory\&quot;:false,\&quot;primary\&quot;:false}]},{\&quot;id\&quot;:\&quot;&quot; + nowId2 + &quot;\&quot;,\&quot;name\&quot;:\&quot;Attachment of Earnings\&quot;,\&quot;text\&quot;:\&quot;NowLevel/Attachment\&quot;,\&quot;templateName\&quot;:\&quot;AttachmentTemplate\&quot;,\&quot;rank\&quot;:2,\&quot;jurisdiction\&quot;:\&quot;B\&quot;,\&quot;remotePrintingRequired\&quot;:false,\&quot;resultDefinitions\&quot;:[{\&quot;id\&quot;:\&quot;&quot; + resultDefId3 + &quot;\&quot;,\&quot;mandatory\&quot;:true,\&quot;primary\&quot;:true}]}]}&quot;
    
    // Stub for any date query parameter
    stubFor(get(urlPathEqualTo(nowsMetadataUrl))
            .withQueryParam(&quot;on&quot;, matching(&quot;.*&quot;))
            .withHeader(&quot;Accept&quot;, equalTo(nowsMetadataMediaType))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, nowsMetadataMediaType)
                    .withBody(nowsMetadataJson)))
    
    log.info(&quot;WireMock stub for nows metadata configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub for nows metadata: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubCourtrooms" enabled="true">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    // Stub courtrooms
    String courtroomsUrl = &quot;/referencedata-service/query/api/rest/referencedata/courtrooms&quot;
    String courtroomsMediaType = &quot;application/vnd.referencedata.ou-courtrooms+json&quot;
    
    // Courtrooms response matching the structure from integration tests
    String courtCentreId = &quot;b52f805c-2821-4904-a0e0-26f7fda6dd08&quot;
    String roomId = &quot;5d5d7b5e-7833-4dc1-b94a-d1a5c635c623&quot;
    String courtroomsJson = &quot;{\&quot;organisationunits\&quot;:[{\&quot;id\&quot;:\&quot;&quot; + courtCentreId + &quot;\&quot;,\&quot;oucodeL3Name\&quot;:\&quot;Liverpool Crown Court\&quot;,\&quot;isWelsh\&quot;:false,\&quot;courtrooms\&quot;:[{\&quot;id\&quot;:\&quot;&quot; + roomId + &quot;\&quot;,\&quot;venueName\&quot;:\&quot;Liverpool Crown Court\&quot;,\&quot;courtroomName\&quot;:\&quot;CourtRoom 1\&quot;}]},{\&quot;id\&quot;:\&quot;&quot; + courtCentreId + &quot;\&quot;,\&quot;oucode\&quot;:\&quot;B01BE01\&quot;,\&quot;oucodeL1Code\&quot;:\&quot;C\&quot;,\&quot;oucodeL3Name\&quot;:\&quot;Wimbledon\&quot;,\&quot;address1\&quot;:\&quot;4 Belmarsh Road\&quot;,\&quot;address2\&quot;:\&quot;London\&quot;,\&quot;postcode\&quot;:\&quot;SE28 0HA\&quot;,\&quot;defaultStartTime\&quot;:\&quot;10:00\&quot;,\&quot;defaultDurationHrs\&quot;:\&quot;7:00\&quot;,\&quot;isWelsh\&quot;:false,\&quot;courtrooms\&quot;:[{\&quot;id\&quot;:\&quot;f703dc83-d0e4-42c8-8d44-0352d46e5194\&quot;,\&quot;venueName\&quot;:\&quot;WIMBLEDON MAGISTRATES&apos; COURT\&quot;,\&quot;courtroomId\&quot;:789,\&quot;courtroomName\&quot;:\&quot;Room A\&quot;,\&quot;oucodeL3Name\&quot;:\&quot;Wimbledon\&quot;},{\&quot;id\&quot;:\&quot;2bd3e322-f603-411d-a5ab-2e42ff4b6e00\&quot;,\&quot;venueName\&quot;:\&quot;WIMBLEDON MAGISTRATES&apos; COURT\&quot;,\&quot;courtroomId\&quot;:790,\&quot;courtroomName\&quot;:\&quot;Room B\&quot;,\&quot;oucodeL3Name\&quot;:\&quot;Wimbledon\&quot;}]}]}&quot;
    
    stubFor(get(urlPathEqualTo(courtroomsUrl))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, courtroomsMediaType)
                    .withBody(courtroomsJson)))
    
    log.info(&quot;WireMock stub for courtrooms configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub for courtrooms: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubCrackedIneffectiveVacatedTrialTypes" enabled="true">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    // Stub cracked-ineffective-vacated-trial-types
    String trialTypesUrl = &quot;/referencedata-service/query/api/rest/referencedata/cracked-ineffective-vacated-trial-types&quot;
    String trialTypesMediaType = &quot;application/vnd.referencedata.cracked-ineffective-vacated-trial-types+json&quot;
    
    // Trial types response matching the structure from integration tests
    String trialTypesJson = &quot;{\&quot;crackedIneffectiveVacatedTrialTypes\&quot;:[{\&quot;id\&quot;:\&quot;9b738c6e-04fc-4e18-bc49-b599973af7e7\&quot;,\&quot;reasonCode\&quot;:\&quot;code\&quot;,\&quot;trialType\&quot;:\&quot;InEffective\&quot;,\&quot;reasonShortDescription\&quot;:\&quot;Prosecution witness absent: police\&quot;,\&quot;reasonFullDescription\&quot;:\&quot;fullDescription\&quot;,\&quot;date\&quot;:null},{\&quot;id\&quot;:\&quot;9c738c6e-04fc-4e18-bc49-b599973af7b8\&quot;,\&quot;reasonCode\&quot;:\&quot;code\&quot;,\&quot;trialType\&quot;:\&quot;Vacated\&quot;,\&quot;reasonShortDescription\&quot;:\&quot;Prosecution failed to disclose unused material\&quot;,\&quot;reasonFullDescription\&quot;:\&quot;fullDescription\&quot;,\&quot;date\&quot;:null},{\&quot;id\&quot;:\&quot;9d738c6e-04fc-4e18-bc49-b599973af7c6\&quot;,\&quot;reasonCode\&quot;:\&quot;code\&quot;,\&quot;trialType\&quot;:\&quot;Cracked\&quot;,\&quot;reasonShortDescription\&quot;:\&quot;Prosecution not ready: specify in comments\&quot;,\&quot;reasonFullDescription\&quot;:\&quot;fullDescription\&quot;,\&quot;date\&quot;:null}]}&quot;
    
    stubFor(get(urlPathEqualTo(trialTypesUrl))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, trialTypesMediaType)
                    .withBody(trialTypesJson)))
    
    log.info(&quot;WireMock stub for cracked-ineffective-vacated-trial-types configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub for cracked-ineffective-vacated-trial-types: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubResultDefinitions" enabled="true">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    // Stub result definitions
    String resultDefinitionsUrl = &quot;/referencedata-service/query/api/rest/referencedata/result-definitions&quot;
    String resultDefinitionsMediaType = &quot;application/vnd.referencedata.get-all-result-definitions+json&quot;
    
    // Minimal result definitions response - includes the result definition IDs used in the test
    String resultDefId1 = &quot;969f150c-cd05-46b0-9dd9-30891efcc766&quot;
    String resultDefId2 = &quot;1f3c83cc-53eb-4861-8cb8-2289b4a08307&quot;
    String resultDefinitionsJson = &quot;{\&quot;resultDefinitions\&quot;:[{\&quot;id\&quot;:\&quot;&quot; + resultDefId1 + &quot;\&quot;,\&quot;version\&quot;:\&quot;2021-12-10T10:23:51.677Z\&quot;,\&quot;startDate\&quot;:\&quot;2021-12-11\&quot;,\&quot;label\&quot;:\&quot;Fine\&quot;,\&quot;shortCode\&quot;:\&quot;FINE\&quot;,\&quot;level\&quot;:\&quot;OFFENCE\&quot;,\&quot;rank\&quot;:100,\&quot;wordGroups\&quot;:[{\&quot;wordGroup\&quot;:[\&quot;FINE\&quot;]}],\&quot;prompts\&quot;:[{\&quot;id\&quot;:\&quot;&quot; + resultDefId1 + &quot;\&quot;,\&quot;label\&quot;:\&quot;promptLabel\&quot;,\&quot;resultPromptRule\&quot;:\&quot;mandatory\&quot;,\&quot;type\&quot;:\&quot;FIXL\&quot;,\&quot;sequence\&quot;:100,\&quot;financial\&quot;:\&quot;N\&quot;,\&quot;reference\&quot;:\&quot;bailConditionReason\&quot;,\&quot;fixedListCode\&quot;:\&quot;fixedListCode\&quot;,\&quot;userGroups\&quot;:[],\&quot;courtExtract\&quot;:\&quot;N\&quot;,\&quot;jurisdiction\&quot;:\&quot;B\&quot;,\&quot;hidden\&quot;:false,\&quot;referenceDataKey\&quot;:\&quot;bailConditionReason\&quot;,\&quot;nameEmail\&quot;:false,\&quot;associatedWithReferenceData\&quot;:true}],\&quot;financial\&quot;:\&quot;Y\&quot;,\&quot;unscheduled\&quot;:false,\&quot;adjournment\&quot;:\&quot;N\&quot;,\&quot;category\&quot;:\&quot;I\&quot;,\&quot;urgent\&quot;:false,\&quot;convicted\&quot;:\&quot;N\&quot;,\&quot;d20\&quot;:false,\&quot;postHearingCustodyStatus\&quot;:\&quot;A\&quot;,\&quot;terminatesOffenceProceedings\&quot;:false,\&quot;lifeDuration\&quot;:false,\&quot;rollUpPrompts\&quot;:false,\&quot;publishedForNows\&quot;:false,\&quot;publishedAsAPrompt\&quot;:false,\&quot;excludedFromResults\&quot;:false,\&quot;alwaysPublished\&quot;:false,\&quot;jurisdiction\&quot;:\&quot;B\&quot;,\&quot;canBeSubjectOfBreach\&quot;:false,\&quot;canBeSubjectOfVariation\&quot;:false,\&quot;isAvailableForCourtExtract\&quot;:true,\&quot;isBooleanResult\&quot;:false},{\&quot;id\&quot;:\&quot;&quot; + resultDefId2 + &quot;\&quot;,\&quot;version\&quot;:\&quot;2021-12-10T10:23:51.677Z\&quot;,\&quot;startDate\&quot;:\&quot;2021-12-11\&quot;,\&quot;label\&quot;:\&quot;Result Definition\&quot;,\&quot;shortCode\&quot;:\&quot;RD\&quot;,\&quot;level\&quot;:\&quot;OFFENCE\&quot;,\&quot;rank\&quot;:200,\&quot;wordGroups\&quot;:[{\&quot;wordGroup\&quot;:[\&quot;RD\&quot;]}],\&quot;prompts\&quot;:[{\&quot;id\&quot;:\&quot;&quot; + resultDefId2 + &quot;\&quot;,\&quot;label\&quot;:\&quot;promptLabel\&quot;,\&quot;resultPromptRule\&quot;:\&quot;mandatory\&quot;,\&quot;type\&quot;:\&quot;FIXL\&quot;,\&quot;sequence\&quot;:100,\&quot;financial\&quot;:\&quot;N\&quot;,\&quot;reference\&quot;:\&quot;bailConditionReason\&quot;,\&quot;fixedListCode\&quot;:\&quot;fixedListCode\&quot;,\&quot;userGroups\&quot;:[],\&quot;courtExtract\&quot;:\&quot;N\&quot;,\&quot;jurisdiction\&quot;:\&quot;B\&quot;,\&quot;hidden\&quot;:false,\&quot;referenceDataKey\&quot;:\&quot;bailConditionReason\&quot;,\&quot;nameEmail\&quot;:false,\&quot;associatedWithReferenceData\&quot;:true}],\&quot;financial\&quot;:\&quot;N\&quot;,\&quot;unscheduled\&quot;:false,\&quot;adjournment\&quot;:\&quot;N\&quot;,\&quot;category\&quot;:\&quot;I\&quot;,\&quot;urgent\&quot;:false,\&quot;convicted\&quot;:\&quot;N\&quot;,\&quot;d20\&quot;:false,\&quot;postHearingCustodyStatus\&quot;:\&quot;A\&quot;,\&quot;terminatesOffenceProceedings\&quot;:false,\&quot;lifeDuration\&quot;:false,\&quot;rollUpPrompts\&quot;:false,\&quot;publishedForNows\&quot;:false,\&quot;publishedAsAPrompt\&quot;:false,\&quot;excludedFromResults\&quot;:false,\&quot;alwaysPublished\&quot;:false,\&quot;jurisdiction\&quot;:\&quot;B\&quot;,\&quot;canBeSubjectOfBreach\&quot;:false,\&quot;canBeSubjectOfVariation\&quot;:false,\&quot;isAvailableForCourtExtract\&quot;:true,\&quot;isBooleanResult\&quot;:false}]}&quot;
    
    // Stub for any date query parameter
    stubFor(get(urlPathEqualTo(resultDefinitionsUrl))
            .withQueryParam(&quot;on&quot;, matching(&quot;.*&quot;))
            .withHeader(&quot;Accept&quot;, equalTo(resultDefinitionsMediaType))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, resultDefinitionsMediaType)
                    .withBody(resultDefinitionsJson)))
    
    log.info(&quot;WireMock stub for result definitions configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub for result definitions: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubFixedList" enabled="true">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    // Stub fixed list
    String fixedListUrl = &quot;/referencedata-service/query/api/rest/referencedata/fixed-list&quot;
    String fixedListMediaType = &quot;application/vnd.referencedata.get-all-fixed-list+json&quot;
    
    // Fixed list response matching the structure from integration tests
    String fixedListJson = &quot;{\&quot;fixedListCollection\&quot;:[{\&quot;id\&quot;:\&quot;d06f6539-2a7c-4bc8-bca3-A1e5a225471a\&quot;,\&quot;version\&quot;:\&quot;2018-04-19T10:44:50.219Z\&quot;,\&quot;elements\&quot;:[{\&quot;code\&quot;:\&quot;CON\&quot;,\&quot;value\&quot;:\&quot;Convicted\&quot;},{\&quot;code\&quot;:\&quot;ACQ\&quot;,\&quot;value\&quot;:\&quot;Acquitted\&quot;}]}]}&quot;
    
    // Stub for any date query parameter
    stubFor(get(urlPathEqualTo(fixedListUrl))
            .withQueryParam(&quot;on&quot;, matching(&quot;.*&quot;))
            .withHeader(&quot;Accept&quot;, equalTo(fixedListMediaType))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, fixedListMediaType)
                    .withBody(fixedListJson)))
    
    log.info(&quot;WireMock stub for fixed list configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub for fixed list: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubVerdictTypes" enabled="true">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    // Stub verdict types
    String verdictTypesUrl = &quot;/referencedata-service/query/api/rest/referencedata/verdict-types&quot;
    String verdictTypesMediaType = &quot;application/vnd.reference-data.verdict-types+json&quot;
    
    // Verdict types response matching the structure from integration tests
    String verdictTypesJson = &quot;{\&quot;verdictTypes\&quot;:[{\&quot;id\&quot;:\&quot;c4ca4238-a0b9-3382-8dcc-509a6f75849b\&quot;,\&quot;verdictCode\&quot;:\&quot;VC01\&quot;,\&quot;category\&quot;:\&quot;Guilty\&quot;,\&quot;categoryType\&quot;:\&quot;GUILTY_BY_JURY_CONVICTED\&quot;,\&quot;description\&quot;:\&quot;Guilty\&quot;,\&quot;sequence\&quot;:1,\&quot;cjsVerdictCode\&quot;:\&quot;G\&quot;},{\&quot;id\&quot;:\&quot;c51ce410-c124-310e-8db5-e4b97fc2af39\&quot;,\&quot;verdictCode\&quot;:\&quot;VC13\&quot;,\&quot;category\&quot;:\&quot;Not Guilty\&quot;,\&quot;categoryType\&quot;:\&quot;NOT_GUILTY\&quot;,\&quot;description\&quot;:\&quot;Not guilty by reason of insanity\&quot;,\&quot;sequence\&quot;:13,\&quot;cjsVerdictCode\&quot;:\&quot;N\&quot;}]}&quot;
    
    stubFor(get(urlPathEqualTo(verdictTypesUrl))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, verdictTypesMediaType)
                    .withBody(verdictTypesJson)))
    
    log.info(&quot;WireMock stub for verdict types configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub for verdict types: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubAlcoholLevelMethods" enabled="true">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    // Stub alcohol level methods
    String alcoholLevelMethodsUrl = &quot;/referencedata-service/query/api/rest/referencedata/alcohol-level-methods&quot;
    String alcoholLevelMethodsMediaType = &quot;application/vnd.referencedata.alcohol-level-methods+json&quot;
    
    // Alcohol level methods response matching the structure from integration tests
    String alcoholMethodId1 = UUID.randomUUID().toString()
    String alcoholMethodId2 = UUID.randomUUID().toString()
    String alcoholLevelMethodsJson = &quot;{\&quot;alcoholLevelMethods\&quot;:[{\&quot;id\&quot;:\&quot;&quot; + alcoholMethodId1 + &quot;\&quot;,\&quot;seqNo\&quot;:1,\&quot;methodCode\&quot;:\&quot;A\&quot;,\&quot;methodDescription\&quot;:\&quot;Blood\&quot;},{\&quot;id\&quot;:\&quot;&quot; + alcoholMethodId2 + &quot;\&quot;,\&quot;seqNo\&quot;:2,\&quot;methodCode\&quot;:\&quot;B\&quot;,\&quot;methodDescription\&quot;:\&quot;Breath\&quot;}]}&quot;
    
    stubFor(get(urlPathEqualTo(alcoholLevelMethodsUrl))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, alcoholLevelMethodsMediaType)
                    .withBody(alcoholLevelMethodsJson)))
    
    log.info(&quot;WireMock stub for alcohol level methods configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub for alcohol level methods: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubBailStatuses" enabled="true">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    // Stub bail statuses
    String bailStatusesUrl = &quot;/referencedata-service/query/api/rest/referencedata/bail-statuses&quot;
    String bailStatusesMediaType = &quot;application/vnd.referencedata.bail-statuses+json&quot;
    
    // Bail statuses response matching the structure from integration tests
    String bailStatusesJson = &quot;{\&quot;bailStatuses\&quot;:[{\&quot;statusDescription\&quot;:\&quot;Conditional Bail\&quot;,\&quot;statusRanking\&quot;:1,\&quot;id\&quot;:\&quot;b81ac80b-81a9-48b6-87b0-cc34610eec97\&quot;,\&quot;statusCode\&quot;:\&quot;B\&quot;},{\&quot;statusDescription\&quot;:\&quot;Unconditional Bail\&quot;,\&quot;statusRanking\&quot;:2,\&quot;id\&quot;:\&quot;b81ac80b-81a9-48b6-87b0-cc34610eec98\&quot;,\&quot;statusCode\&quot;:\&quot;U\&quot;},{\&quot;statusDescription\&quot;:\&quot;Not applicable\&quot;,\&quot;statusRanking\&quot;:3,\&quot;id\&quot;:\&quot;b81ac80b-81a9-48b6-87b0-cc34610eec99\&quot;,\&quot;statusCode\&quot;:\&quot;A\&quot;},{\&quot;statusDescription\&quot;:\&quot;Remanded into Custody\&quot;,\&quot;statusRanking\&quot;:4,\&quot;id\&quot;:\&quot;5aaecac5-222b-402d-9047-84803679edac\&quot;,\&quot;statusCode\&quot;:\&quot;C\&quot;}]}&quot;
    
    // Stub for any date path parameter or base URL
    stubFor(get(urlMatching(bailStatusesUrl + &quot;.*&quot;))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, bailStatusesMediaType)
                    .withBody(bailStatusesJson)))
    
    log.info(&quot;WireMock stub for bail statuses configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub for bail statuses: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubResultDefinitionsWithCategory" enabled="true">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    // Stub result definitions with category
    String resultDefinitionsWithCategoryUrl = &quot;/referencedata-service/query/api/rest/referencedata/result-definitions&quot;
    String resultDefinitionsWithCategoryMediaType = &quot;application/vnd.referencedata.query-result-definitions-with-category+json&quot;
    
    // Result definitions with category response matching the structure from integration tests
    String resultDefinitionsWithCategoryJson = &quot;{\&quot;resultDefinitions\&quot;:[{\&quot;id\&quot;:\&quot;969f150c-cd05-46b0-9dd9-30891efcc766\&quot;},{\&quot;id\&quot;:\&quot;45b0c1fe-afe6-4652-822f-7842d79eada9\&quot;}]}&quot;
    
    // Stub for category query parameter (e.g., &quot;F&quot;) and date query parameter
    stubFor(get(urlPathEqualTo(resultDefinitionsWithCategoryUrl))
            .withQueryParam(&quot;category&quot;, matching(&quot;.*&quot;))
            .withQueryParam(&quot;on&quot;, matching(&quot;.*&quot;))
            .withHeader(&quot;Accept&quot;, equalTo(resultDefinitionsWithCategoryMediaType))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, resultDefinitionsWithCategoryMediaType)
                    .withBody(resultDefinitionsWithCategoryJson)))
    
    log.info(&quot;WireMock stub for result definitions with category configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub for result definitions with category: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubHearingTypes">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    // Stub hearing types
    String hearingTypesUrl = &quot;/referencedata-service/query/api/rest/referencedata/hearing-types&quot;
    String hearingTypesMediaType = &quot;application/vnd.referencedata.query.hearing-types+json&quot;
    
    // Hearing types response - includes the hearing type ID used in the test (9cc41e45-b594-4ba6-906e-1a4626b08fed)
    String hearingTypesJson = &quot;{\&quot;hearingTypes\&quot;:[{\&quot;id\&quot;:\&quot;9cc41e45-b594-4ba6-906e-1a4626b08fed\&quot;,\&quot;seqId\&quot;:29,\&quot;hearingCode\&quot;:\&quot;FPTP\&quot;,\&quot;hearingDescription\&quot;:\&quot;Further Plea and Trial Preparation\&quot;,\&quot;welshHearingDescription\&quot;:\&quot;Diffynnydd i fynychu 2\&quot;,\&quot;defaultDurationMin\&quot;:20,\&quot;validFrom\&quot;:null,\&quot;validTo\&quot;:null,\&quot;exhibitHearingCode\&quot;:\&quot;CCT\&quot;,\&quot;exhibitHearingDescription\&quot;:\&quot;Plea and Trial Preparation\&quot;,\&quot;trialTypeFlag\&quot;:true},{\&quot;id\&quot;:\&quot;8dd41e45-b594-4ba6-906e-1a4626b08fed\&quot;,\&quot;seqId\&quot;:28,\&quot;hearingCode\&quot;:\&quot;PTP\&quot;,\&quot;hearingDescription\&quot;:\&quot;Plea and Trial Preparation\&quot;,\&quot;welshHearingDescription\&quot;:\&quot;Diffynnydd i fynychu i\&quot;,\&quot;defaultDurationMin\&quot;:20,\&quot;validFrom\&quot;:null,\&quot;validTo\&quot;:null,\&quot;exhibitHearingCode\&quot;:\&quot;CCT\&quot;,\&quot;exhibitHearingDescription\&quot;:\&quot;Plea and Trial Preparation\&quot;,\&quot;trialTypeFlag\&quot;:false}]}&quot;
    
    stubFor(get(urlPathEqualTo(hearingTypesUrl))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, hearingTypesMediaType)
                    .withBody(hearingTypesJson)))
    
    log.info(&quot;WireMock stub for hearing types configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub for hearing types: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <TestAction guiclass="TestActionGui" testclass="TestAction" testname="Flow Control Action" enabled="true">
          <intProp name="ActionProcessor.action">1</intProp>
          <intProp name="ActionProcessor.target">0</intProp>
          <stringProp name="ActionProcessor.duration">0</stringProp>
        </TestAction>
        <hashTree>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="Initializer" enabled="true">
            <stringProp name="scriptLanguage">groovy</stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="script">import org.apache.jmeter.services.FileServer;
import org.apache.jmeter.util.JMeterUtils;

def baseDir = FileServer.getFileServer().getBaseDir();
def projectRoot = new File(baseDir).getParentFile();
def dataDir = new File(projectRoot, &quot;data&quot;)

// Save as variable
JMeterUtils.setProperty(&quot;DATA_DIR&quot;, dataDir.getAbsolutePath())

log.info(&quot;DATA_DIR -&gt; &quot; + dataDir.getAbsolutePath())
log.info(&quot;thread count -&gt; &quot; + vars.get(&quot;numberOfThreads&quot;))


</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
      </hashTree>
      <ThreadGroup guiclass="ThreadGroupGui" testclass="ThreadGroup" testname="ShareResultsForHearingWithMultipleCasesWithApplicationClearVerdict" enabled="false">
        <stringProp name="ThreadGroup.num_threads">${numberOfThreads}</stringProp>
        <stringProp name="ThreadGroup.ramp_time">${rampUpPeriod}</stringProp>
        <boolProp name="ThreadGroup.same_user_on_next_iteration">true</boolProp>
        <stringProp name="ThreadGroup.on_sample_error">continue</stringProp>
        <elementProp name="ThreadGroup.main_controller" elementType="LoopController" guiclass="LoopControlPanel" testclass="LoopController" testname="Loop Controller">
          <stringProp name="LoopController.loops">${loopCount}</stringProp>
          <boolProp name="LoopController.continue_forever">false</boolProp>
        </elementProp>
      </ThreadGroup>
      <hashTree>
        <ConfigTestElement guiclass="HttpDefaultsGui" testclass="ConfigTestElement" testname="HTTP Request Defaults" enabled="true">
          <stringProp name="HTTPSampler.domain">${hostName}</stringProp>
          <stringProp name="HTTPSampler.port">${port}</stringProp>
          <stringProp name="HTTPSampler.protocol">${protocol}</stringProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
            <collectionProp name="Arguments.arguments"/>
          </elementProp>
          <stringProp name="HTTPSampler.implementation"></stringProp>
        </ConfigTestElement>
        <hashTree/>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Initiate Hearing" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.initiate+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="InitiateHearingPreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;initiate-hearing-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text
vars.put(&quot;hearingId&quot;, UUID.randomUUID().toString())
log.info(&quot;hearingId-&gt; &quot; + vars.get(&quot;hearingId&quot;))

vars.put(&quot;applicationId&quot;, UUID.randomUUID().toString())
log.info(&quot;applicationId-&gt; &quot; + vars.get(&quot;applicationId&quot;))

vars.put(&quot;caseId&quot;, UUID.randomUUID().toString())
log.info(&quot;caseId-&gt; &quot; + vars.get(&quot;caseId&quot;))

vars.put(&quot;courtOrderId&quot;, UUID.randomUUID().toString())
log.info(&quot;courtOrderId-&gt; &quot; + vars.get(&quot;courtOrderId&quot;))

vars.put(&quot;defendantId&quot;, UUID.randomUUID().toString())
log.info(&quot;defendantId-&gt; &quot; + vars.get(&quot;defendantId&quot;))

vars.put(&quot;offenceId&quot;, UUID.randomUUID().toString())
log.info(&quot;offenceId-&gt; &quot; + vars.get(&quot;offenceId&quot;))

vars.put(&quot;courtOrderOffenceId&quot;, UUID.randomUUID().toString())
log.info(&quot;courtOrderOffenceId-&gt; &quot; + vars.get(&quot;courtOrderOffenceId&quot;))

vars.put(&quot;courtApplicationOffenceId&quot;, UUID.randomUUID().toString())
log.info(&quot;courtApplicationOffenceId-&gt; &quot; + vars.get(&quot;courtApplicationOffenceId&quot;))

vars.put(&quot;courtApplicationCaseId&quot;, UUID.randomUUID().toString())
log.info(&quot;courtApplicationCaseId-&gt; &quot; + vars.get(&quot;courtApplicationCaseId&quot;))

vars.put(&quot;courtOrderCaseId&quot;, UUID.randomUUID().toString())
log.info(&quot;courtOrderCaseId-&gt; &quot; + vars.get(&quot;courtOrderCaseId&quot;))
def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <ConstantTimer guiclass="ConstantTimerGui" testclass="ConstantTimer" testname="Constant Timer" enabled="true">
          <stringProp name="ConstantTimer.delay">1000</stringProp>
        </ConstantTimer>
        <hashTree/>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Update Defendant Attendance" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.update-defendant-attendance-on-hearing-day+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="UpdateDefendantAttendancePreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;update-defendant-attendance-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

def evaluatedJson = new CompoundVariable(rawJson).execute()


vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Add Prosecution Counsel" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings/${hearingId}</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.add-prosecution-counsel+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="AddProsecutionCounselPreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;add-prosecution-counsel-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

vars.put(&quot;prosecutionCounselId&quot;, UUID.randomUUID().toString())
log.info(&quot;prosecutionCounselId-&gt; &quot; + vars.get(&quot;prosecutionCounselId&quot;))

def evaluatedJson = new CompoundVariable(rawJson).execute()


vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Update Verdict" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings/${hearingId}</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.update-verdict+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="UpdateVerdictPreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;update-verdict-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

def evaluatedJson = new CompoundVariable(rawJson).execute()


vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Shared Results" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings/${hearingId}/${hearingDay}</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.shared-results+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="SharedResultsPreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;shared-results-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

vars.put(&quot;hearingDay&quot;, &quot;2026-01-23&quot;)
log.info(&quot;hearingDay-&gt; &quot; + vars.get(&quot;hearingDay&quot;))

vars.put(&quot;resultLineId&quot;, UUID.randomUUID().toString())
log.info(&quot;resultLineId-&gt; &quot; + vars.get(&quot;resultLineId&quot;))

def evaluatedJson = new CompoundVariable(rawJson).execute()


vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Update Verdict 2" enabled="false">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings/${hearingId}</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.update-verdict+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="UpdateVerdict2PreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;update-verdict-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

def evaluatedJson = new CompoundVariable(rawJson).execute()


vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Shared Results 2" enabled="false">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings/${hearingId}/${hearingDay}</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.shared-results+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="SharedResults2PreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;shared-results-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

vars.put(&quot;resultLineId&quot;, UUID.randomUUID().toString())
log.info(&quot;resultLineId-&gt; &quot; + vars.get(&quot;resultLineId&quot;))

def evaluatedJson = new CompoundVariable(rawJson).execute()


vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <ResultCollector guiclass="SimpleDataWriter" testclass="ResultCollector" testname="Simple Data Writer" enabled="true">
          <boolProp name="ResultCollector.error_logging">false</boolProp>
          <objProp>
            <name>saveConfig</name>
            <value class="SampleSaveConfiguration">
              <time>true</time>
              <latency>true</latency>
              <timestamp>true</timestamp>
              <success>true</success>
              <label>true</label>
              <code>true</code>
              <message>true</message>
              <threadName>true</threadName>
              <dataType>true</dataType>
              <encoding>false</encoding>
              <assertions>true</assertions>
              <subresults>true</subresults>
              <responseData>false</responseData>
              <samplerData>false</samplerData>
              <xml>false</xml>
              <fieldNames>true</fieldNames>
              <responseHeaders>false</responseHeaders>
              <requestHeaders>false</requestHeaders>
              <responseDataOnError>false</responseDataOnError>
              <saveAssertionResultsFailureMessage>true</saveAssertionResultsFailureMessage>
              <assertionsResultsToSave>0</assertionsResultsToSave>
              <bytes>true</bytes>
              <sentBytes>true</sentBytes>
              <url>true</url>
              <threadCounts>true</threadCounts>
              <idleTime>true</idleTime>
              <connectTime>true</connectTime>
            </value>
          </objProp>
          <stringProp name="filename">${resultDir}/ShareResultsForHearingWithMultipleCasesWithApplicationClearVerdict.csv</stringProp>
        </ResultCollector>
        <hashTree/>
      </hashTree>
      <ThreadGroup guiclass="ThreadGroupGui" testclass="ThreadGroup" testname="CourtListRestriction">
        <stringProp name="ThreadGroup.num_threads">${numberOfThreads}</stringProp>
        <stringProp name="ThreadGroup.ramp_time">${rampUpPeriod}</stringProp>
        <boolProp name="ThreadGroup.same_user_on_next_iteration">true</boolProp>
        <stringProp name="ThreadGroup.on_sample_error">continue</stringProp>
        <elementProp name="ThreadGroup.main_controller" elementType="LoopController" guiclass="LoopControlPanel" testclass="LoopController" testname="Loop Controller">
          <stringProp name="LoopController.loops">${loopCount}</stringProp>
          <boolProp name="LoopController.continue_forever">false</boolProp>
        </elementProp>
      </ThreadGroup>
      <hashTree>
        <ConfigTestElement guiclass="HttpDefaultsGui" testclass="ConfigTestElement" testname="HTTP Request Defaults">
          <stringProp name="HTTPSampler.domain">${hostName}</stringProp>
          <stringProp name="HTTPSampler.port">${port}</stringProp>
          <stringProp name="HTTPSampler.protocol">${protocol}</stringProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
            <collectionProp name="Arguments.arguments"/>
          </elementProp>
          <stringProp name="HTTPSampler.implementation"></stringProp>
        </ConfigTestElement>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubSetup">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    String xhibitGatewayPathRegex = &quot;/xhibit-gateway/send-to-xhibit/.*\\.xml&quot;
    
    stubFor(put(urlPathMatching(xhibitGatewayPathRegex))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())))
    
    log.info(&quot;WireMock stub for Xhibit gateway file upload configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <Arguments guiclass="ArgumentsPanel" testclass="Arguments" testname="User Defined Variables" enabled="false">
          <collectionProp name="Arguments.arguments">
            <elementProp name="courtCentreId" elementType="Argument">
              <stringProp name="Argument.name">courtCentreId</stringProp>
              <stringProp name="Argument.value">${__UUID}</stringProp>
              <stringProp name="Argument.metadata">=</stringProp>
            </elementProp>
          </collectionProp>
        </Arguments>
        <hashTree/>
        <LoopController guiclass="LoopControlPanel" testclass="LoopController" testname="Loop Controller">
          <stringProp name="LoopController.loops">3</stringProp>
        </LoopController>
        <hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Initiate Hearing 1" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">${jsonMessage}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
            <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">CJSCPPUID</stringProp>
                  <stringProp name="Header.value">${userId}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/vnd.hearing.initiate+json</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="CourtListRestrictionInitiateHearing1PreProcessor" enabled="true">
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;court-list-restriction-initiate-hearing-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

vars.put(&quot;hearingId1&quot;, UUID.randomUUID().toString())
log.info(&quot;hearingId1-&gt; &quot; + vars.get(&quot;hearingId1&quot;))

vars.put(&quot;defendantId1&quot;, UUID.randomUUID().toString())
log.info(&quot;defendantId1-&gt; &quot; + vars.get(&quot;defendantId1&quot;))

vars.put(&quot;defenceCounselId1&quot;, UUID.randomUUID().toString())
log.info(&quot;defenceCounselId1-&gt; &quot; + vars.get(&quot;defenceCounselId1&quot;))

vars.put(&quot;defendantReferralReasonId1&quot;, UUID.randomUUID().toString())
log.info(&quot;defendantReferralReasonId1-&gt; &quot; + vars.get(&quot;defendantReferralReasonId1&quot;))

vars.put(&quot;caseId1&quot;, UUID.randomUUID().toString())
log.info(&quot;caseId1-&gt; &quot; + vars.get(&quot;caseId1&quot;))

vars.put(&quot;offenceId1&quot;, UUID.randomUUID().toString())
log.info(&quot;offenceId1-&gt; &quot; + vars.get(&quot;offenceId1&quot;))

vars.put(&quot;hearingId&quot;, vars.get(&quot;hearingId1&quot;))
vars.put(&quot;defendantId&quot;, vars.get(&quot;defendantId1&quot;))
vars.put(&quot;defenceCounselId&quot;, vars.get(&quot;defenceCounselId1&quot;))
vars.put(&quot;defendantReferralReasonId&quot;, vars.get(&quot;defendantReferralReasonId1&quot;))
vars.put(&quot;caseId&quot;, vars.get(&quot;caseId1&quot;))
vars.put(&quot;offenceId&quot;, vars.get(&quot;offenceId1&quot;))

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
              <stringProp name="scriptLanguage">groovy</stringProp>
            </JSR223PreProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Log Hearing Event 1" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings/${hearingId1}/event</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">${jsonMessage}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
            <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">CJSCPPUID</stringProp>
                  <stringProp name="Header.value">${userId}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/vnd.hearing.log-hearing-event+json</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="LogHearingEvent1PreProcessor" enabled="true">
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;log-hearing-event-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

vars.put(&quot;hearingEventId&quot;, UUID.randomUUID().toString())
vars.put(&quot;hearingId&quot;, vars.get(&quot;hearingId1&quot;))
vars.put(&quot;defenceCounselId&quot;, vars.get(&quot;defenceCounselId1&quot;))

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
              <stringProp name="scriptLanguage">groovy</stringProp>
            </JSR223PreProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Publish Court List 1" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/publish-court-list</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">${jsonMessage}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
            <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">CJSCPPUID</stringProp>
                  <stringProp name="Header.value">${userId}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/vnd.hearing.publish-court-list+json</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="PublishCourtList1PreProcessor" enabled="true">
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;publish-court-list-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
              <stringProp name="scriptLanguage">groovy</stringProp>
            </JSR223PreProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Publish Court List 2" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/publish-court-list</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">${jsonMessage}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
            <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">CJSCPPUID</stringProp>
                  <stringProp name="Header.value">${userId}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/vnd.hearing.publish-court-list+json</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="PublishCourtList2PreProcessor" enabled="true">
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;publish-court-list-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
              <stringProp name="scriptLanguage">groovy</stringProp>
            </JSR223PreProcessor>
            <hashTree/>
          </hashTree>
        </hashTree>
        <ResultCollector guiclass="SimpleDataWriter" testclass="ResultCollector" testname="Simple Data Writer">
          <boolProp name="ResultCollector.error_logging">false</boolProp>
          <objProp>
            <name>saveConfig</name>
            <value class="SampleSaveConfiguration">
              <time>true</time>
              <latency>true</latency>
              <timestamp>true</timestamp>
              <success>true</success>
              <label>true</label>
              <code>true</code>
              <message>true</message>
              <threadName>true</threadName>
              <dataType>true</dataType>
              <encoding>false</encoding>
              <assertions>true</assertions>
              <subresults>true</subresults>
              <responseData>false</responseData>
              <samplerData>false</samplerData>
              <xml>false</xml>
              <fieldNames>true</fieldNames>
              <responseHeaders>false</responseHeaders>
              <requestHeaders>false</requestHeaders>
              <responseDataOnError>false</responseDataOnError>
              <saveAssertionResultsFailureMessage>true</saveAssertionResultsFailureMessage>
              <assertionsResultsToSave>0</assertionsResultsToSave>
              <bytes>true</bytes>
              <sentBytes>true</sentBytes>
              <url>true</url>
              <threadCounts>true</threadCounts>
              <idleTime>true</idleTime>
              <connectTime>true</connectTime>
            </value>
          </objProp>
          <stringProp name="filename">${resultDir}/CourtListRestriction.csv</stringProp>
        </ResultCollector>
        <hashTree/>
      </hashTree>
      <ThreadGroup guiclass="ThreadGroupGui" testclass="ThreadGroup" testname="CancelRemainingHearingDaysWhenMultidayHearingIsCracked" enabled="false">
        <stringProp name="ThreadGroup.num_threads">${numberOfThreads}</stringProp>
        <stringProp name="ThreadGroup.ramp_time">${rampUpPeriod}</stringProp>
        <boolProp name="ThreadGroup.same_user_on_next_iteration">true</boolProp>
        <stringProp name="ThreadGroup.on_sample_error">continue</stringProp>
        <elementProp name="ThreadGroup.main_controller" elementType="LoopController" guiclass="LoopControlPanel" testclass="LoopController" testname="Loop Controller">
          <stringProp name="LoopController.loops">${loopCount}</stringProp>
          <boolProp name="LoopController.continue_forever">false</boolProp>
        </elementProp>
      </ThreadGroup>
      <hashTree>
        <ConfigTestElement guiclass="HttpDefaultsGui" testclass="ConfigTestElement" testname="HTTP Request Defaults" enabled="true">
          <stringProp name="HTTPSampler.domain">${hostName}</stringProp>
          <stringProp name="HTTPSampler.port">${port}</stringProp>
          <stringProp name="HTTPSampler.protocol">${protocol}</stringProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
            <collectionProp name="Arguments.arguments"/>
          </elementProp>
          <stringProp name="HTTPSampler.implementation"></stringProp>
        </ConfigTestElement>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="WireMockStubResultDefinitions" enabled="false">
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="script">import com.github.tomakehurst.wiremock.client.WireMock
import static com.github.tomakehurst.wiremock.client.WireMock.*
import java.util.UUID

try {
    String wiremockHost = System.getProperty(&quot;WIREMOCK_HOST&quot;, &quot;localhost&quot;)
    int wiremockPort = Integer.parseInt(System.getProperty(&quot;WIREMOCK_PORT&quot;, &quot;8080&quot;))
    
    WireMock.configureFor(wiremockHost, wiremockPort)
    
    String resultDefinitionsUrl = &quot;/referencedata-service/query/api/rest/referencedata/result-definitions&quot;
    String mediaType = &quot;application/vnd.referencedata.get-all-result-definitions+json&quot;
    
    // Minimal result definitions response with the required result definition ID
    // This matches the structure expected by NowsReferenceCache
    String resultDefinitionsJson = &quot;{\&quot;resultDefinitions\&quot;:[{\&quot;id\&quot;:\&quot;1f3c83cc-53eb-4861-8cb8-2289b4a08307\&quot;,\&quot;version\&quot;:\&quot;2021-12-10T10:23:51.677Z\&quot;,\&quot;startDate\&quot;:\&quot;2021-12-11\&quot;,\&quot;label\&quot;:\&quot;imprisonment\&quot;,\&quot;shortCode\&quot;:\&quot;IMP\&quot;,\&quot;level\&quot;:\&quot;OFFENCE\&quot;,\&quot;rank\&quot;:100,\&quot;category\&quot;:\&quot;I\&quot;,\&quot;postHearingCustodyStatus\&quot;:\&quot;C\&quot;,\&quot;lifeDuration\&quot;:true,\&quot;publishedAsAPrompt\&quot;:false,\&quot;excludedFromResults\&quot;:false,\&quot;alwaysPublished\&quot;:true,\&quot;urgent\&quot;:false,\&quot;d20\&quot;:false,\&quot;terminatesOffenceProceedings\&quot;:false,\&quot;financial\&quot;:\&quot;N\&quot;,\&quot;unscheduled\&quot;:false,\&quot;adjournment\&quot;:\&quot;N\&quot;,\&quot;convicted\&quot;:\&quot;Y\&quot;,\&quot;rollUpPrompts\&quot;:false,\&quot;publishedForNows\&quot;:false,\&quot;jurisdiction\&quot;:\&quot;B\&quot;,\&quot;canBeSubjectOfBreach\&quot;:false,\&quot;canBeSubjectOfVariation\&quot;:false,\&quot;isAvailableForCourtExtract\&quot;:true,\&quot;isBooleanResult\&quot;:false,\&quot;prompts\&quot;:[{\&quot;id\&quot;:\&quot;1f3c83cc-53eb-4861-8cb8-2289b4a08307\&quot;,\&quot;label\&quot;:\&quot;promptLabel\&quot;,\&quot;resultPromptRule\&quot;:\&quot;optional\&quot;,\&quot;type\&quot;:\&quot;FIXL\&quot;,\&quot;sequence\&quot;:5,\&quot;financial\&quot;:\&quot;N\&quot;,\&quot;reference\&quot;:\&quot;bailConditionReason\&quot;,\&quot;courtExtract\&quot;:\&quot;N\&quot;,\&quot;jurisdiction\&quot;:\&quot;B\&quot;,\&quot;hidden\&quot;:false,\&quot;nameEmail\&quot;:false}]}]}&quot;
    
    // Stub for any date parameter - matches any query param &quot;on&quot;
    stubFor(get(urlPathEqualTo(resultDefinitionsUrl))
            .withQueryParam(&quot;on&quot;, matching(&quot;.*&quot;))
            .withHeader(&quot;Accept&quot;, equalTo(mediaType))
            .willReturn(aResponse()
                    .withStatus(200)
                    .withHeader(&quot;CPPID&quot;, UUID.randomUUID().toString())
                    .withHeader(&quot;Content-Type&quot;, mediaType)
                    .withBody(resultDefinitionsJson)))
    
    log.info(&quot;WireMock stub for result definitions configured successfully&quot;)
} catch (Exception e) {
    log.warn(&quot;Failed to configure WireMock stub for result definitions: &quot; + e.getMessage())
}</stringProp>
          <stringProp name="scriptLanguage">groovy</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Initiate Hearing" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.initiate+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="CancelRemainingHearingDaysInitiateHearingPreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;cancel-remaining-hearing-days-initiate-hearing-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

vars.put(&quot;hearingId&quot;, UUID.randomUUID().toString())
log.info(&quot;hearingId-&gt; &quot; + vars.get(&quot;hearingId&quot;))

vars.put(&quot;applicationId&quot;, UUID.randomUUID().toString())
log.info(&quot;applicationId-&gt; &quot; + vars.get(&quot;applicationId&quot;))

vars.put(&quot;caseId&quot;, UUID.randomUUID().toString())
log.info(&quot;caseId-&gt; &quot; + vars.get(&quot;caseId&quot;))

vars.put(&quot;courtOrderId&quot;, UUID.randomUUID().toString())
log.info(&quot;courtOrderId-&gt; &quot; + vars.get(&quot;courtOrderId&quot;))

vars.put(&quot;defendantId&quot;, UUID.randomUUID().toString())
log.info(&quot;defendantId-&gt; &quot; + vars.get(&quot;defendantId&quot;))

vars.put(&quot;offenceId&quot;, UUID.randomUUID().toString())
log.info(&quot;offenceId-&gt; &quot; + vars.get(&quot;offenceId&quot;))

vars.put(&quot;courtOrderOffenceId&quot;, UUID.randomUUID().toString())
log.info(&quot;courtOrderOffenceId-&gt; &quot; + vars.get(&quot;courtOrderOffenceId&quot;))

vars.put(&quot;courtApplicationOffenceId&quot;, UUID.randomUUID().toString())
log.info(&quot;courtApplicationOffenceId-&gt; &quot; + vars.get(&quot;courtApplicationOffenceId&quot;))

vars.put(&quot;courtApplicationCaseId&quot;, UUID.randomUUID().toString())
log.info(&quot;courtApplicationCaseId-&gt; &quot; + vars.get(&quot;courtApplicationCaseId&quot;))

vars.put(&quot;courtOrderCaseId&quot;, UUID.randomUUID().toString())
log.info(&quot;courtOrderCaseId-&gt; &quot; + vars.get(&quot;courtOrderCaseId&quot;))

vars.put(&quot;defendantReferralReasonId&quot;, UUID.randomUUID().toString())
log.info(&quot;defendantReferralReasonId-&gt; &quot; + vars.get(&quot;defendantReferralReasonId&quot;))

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Update Defendant Attendance" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.update-defendant-attendance-on-hearing-day+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="CancelRemainingHearingDaysUpdateDefendantAttendancePreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;cancel-remaining-hearing-days-update-defendant-attendance-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Add Prosecution Counsel" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings/${hearingId}</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.add-prosecution-counsel+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="CancelRemainingHearingDaysAddProsecutionCounselPreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;cancel-remaining-hearing-days-add-prosecution-counsel-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

vars.put(&quot;prosecutionCounselId&quot;, UUID.randomUUID().toString())
log.info(&quot;prosecutionCounselId-&gt; &quot; + vars.get(&quot;prosecutionCounselId&quot;))

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Update Verdict" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings/${hearingId}</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.update-verdict+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="CancelRemainingHearingDaysUpdateVerdictPreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;cancel-remaining-hearing-days-update-verdict-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Set Trial Type" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings/${hearingId}</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.set-trial-type+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="CancelRemainingHearingDaysSetTrialTypePreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;cancel-remaining-hearing-days-set-trial-type-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Share Results" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings/${hearingId}/share-results</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.share-results+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="CancelRemainingHearingDaysShareResultsPreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;cancel-remaining-hearing-days-share-results-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

vars.put(&quot;resultLineId&quot;, UUID.randomUUID().toString())
log.info(&quot;resultLineId-&gt; &quot; + vars.get(&quot;resultLineId&quot;))

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <ResultCollector guiclass="SimpleDataWriter" testclass="ResultCollector" testname="Simple Data Writer" enabled="true">
          <boolProp name="ResultCollector.error_logging">false</boolProp>
          <objProp>
            <name>saveConfig</name>
            <value class="SampleSaveConfiguration">
              <time>true</time>
              <latency>true</latency>
              <timestamp>true</timestamp>
              <success>true</success>
              <label>true</label>
              <code>true</code>
              <message>true</message>
              <threadName>true</threadName>
              <dataType>true</dataType>
              <encoding>false</encoding>
              <assertions>true</assertions>
              <subresults>true</subresults>
              <responseData>false</responseData>
              <samplerData>false</samplerData>
              <xml>false</xml>
              <fieldNames>true</fieldNames>
              <responseHeaders>false</responseHeaders>
              <requestHeaders>false</requestHeaders>
              <responseDataOnError>false</responseDataOnError>
              <saveAssertionResultsFailureMessage>true</saveAssertionResultsFailureMessage>
              <assertionsResultsToSave>0</assertionsResultsToSave>
              <bytes>true</bytes>
              <sentBytes>true</sentBytes>
              <url>true</url>
              <threadCounts>true</threadCounts>
              <idleTime>true</idleTime>
              <connectTime>true</connectTime>
            </value>
          </objProp>
          <stringProp name="filename">${resultDir}/CancelRemainingHearingDaysWhenMultidayHearingIsCracked.csv</stringProp>
        </ResultCollector>
        <hashTree/>
      </hashTree>
      <ThreadGroup guiclass="ThreadGroupGui" testclass="ThreadGroup" testname="ResultShouldPublishDDCHResultsOnInitialShareAndNotForAmendAndReshare" enabled="false">
        <stringProp name="ThreadGroup.num_threads">${numberOfThreads}</stringProp>
        <stringProp name="ThreadGroup.ramp_time">${rampUpPeriod}</stringProp>
        <boolProp name="ThreadGroup.same_user_on_next_iteration">true</boolProp>
        <stringProp name="ThreadGroup.on_sample_error">continue</stringProp>
        <elementProp name="ThreadGroup.main_controller" elementType="LoopController" guiclass="LoopControlPanel" testclass="LoopController" testname="Loop Controller">
          <stringProp name="LoopController.loops">${loopCount}</stringProp>
          <boolProp name="LoopController.continue_forever">false</boolProp>
        </elementProp>
      </ThreadGroup>
      <hashTree>
        <ConfigTestElement guiclass="HttpDefaultsGui" testclass="ConfigTestElement" testname="HTTP Request Defaults" enabled="true">
          <stringProp name="HTTPSampler.domain">${hostName}</stringProp>
          <stringProp name="HTTPSampler.port">${port}</stringProp>
          <stringProp name="HTTPSampler.protocol">${protocol}</stringProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
            <collectionProp name="Arguments.arguments"/>
          </elementProp>
          <stringProp name="HTTPSampler.implementation"></stringProp>
        </ConfigTestElement>
        <hashTree/>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Initiate Hearing" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.initiate+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="ResultShouldPublishDDCHInitiateHearingPreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;result-should-publish-ddch-initiate-hearing-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

vars.put(&quot;hearingId&quot;, UUID.randomUUID().toString())
log.info(&quot;hearingId-&gt; &quot; + vars.get(&quot;hearingId&quot;))

vars.put(&quot;applicationId&quot;, UUID.randomUUID().toString())
log.info(&quot;applicationId-&gt; &quot; + vars.get(&quot;applicationId&quot;))

vars.put(&quot;caseId&quot;, UUID.randomUUID().toString())
log.info(&quot;caseId-&gt; &quot; + vars.get(&quot;caseId&quot;))

vars.put(&quot;courtOrderId&quot;, UUID.randomUUID().toString())
log.info(&quot;courtOrderId-&gt; &quot; + vars.get(&quot;courtOrderId&quot;))

vars.put(&quot;defendantId&quot;, UUID.randomUUID().toString())
log.info(&quot;defendantId-&gt; &quot; + vars.get(&quot;defendantId&quot;))

vars.put(&quot;offenceId&quot;, UUID.randomUUID().toString())
log.info(&quot;offenceId-&gt; &quot; + vars.get(&quot;offenceId&quot;))

vars.put(&quot;courtOrderOffenceId&quot;, UUID.randomUUID().toString())
log.info(&quot;courtOrderOffenceId-&gt; &quot; + vars.get(&quot;courtOrderOffenceId&quot;))

vars.put(&quot;courtApplicationOffenceId&quot;, UUID.randomUUID().toString())
log.info(&quot;courtApplicationOffenceId-&gt; &quot; + vars.get(&quot;courtApplicationOffenceId&quot;))

vars.put(&quot;courtApplicationCaseId&quot;, UUID.randomUUID().toString())
log.info(&quot;courtApplicationCaseId-&gt; &quot; + vars.get(&quot;courtApplicationCaseId&quot;))

vars.put(&quot;courtOrderCaseId&quot;, UUID.randomUUID().toString())
log.info(&quot;courtOrderCaseId-&gt; &quot; + vars.get(&quot;courtOrderCaseId&quot;))

vars.put(&quot;defendantReferralReasonId&quot;, UUID.randomUUID().toString())
log.info(&quot;defendantReferralReasonId-&gt; &quot; + vars.get(&quot;defendantReferralReasonId&quot;))

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Update Defendant Attendance" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.update-defendant-attendance-on-hearing-day+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="ResultShouldPublishDDCHUpdateDefendantAttendancePreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;result-should-publish-ddch-update-defendant-attendance-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Add Prosecution Counsel" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings/${hearingId}</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.add-prosecution-counsel+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="ResultShouldPublishDDCHAddProsecutionCounselPreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;result-should-publish-ddch-add-prosecution-counsel-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

vars.put(&quot;prosecutionCounselId&quot;, UUID.randomUUID().toString())
log.info(&quot;prosecutionCounselId-&gt; &quot; + vars.get(&quot;prosecutionCounselId&quot;))

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Update Plea" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings/${hearingId}</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.update-plea+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="ResultShouldPublishDDCHUpdatePleaPreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;result-should-publish-ddch-update-plea-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Set Trial Type" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings/${hearingId}</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.set-trial-type+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="ResultShouldPublishDDCHSetTrialTypePreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;result-should-publish-ddch-set-trial-type-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Share Results Initial" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings/${hearingId}/share-results</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.share-results+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="ResultShouldPublishDDCHShareResultsInitialPreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;result-should-publish-ddch-share-results-initial-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

vars.put(&quot;resultLineId1&quot;, UUID.randomUUID().toString())
log.info(&quot;resultLineId1-&gt; &quot; + vars.get(&quot;resultLineId1&quot;))

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Share Results Amend" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings/${hearingId}/share-results</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.share-results+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="ResultShouldPublishDDCHShareResultsAmendPreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;result-should-publish-ddch-share-results-amend-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

vars.put(&quot;resultLineId2&quot;, UUID.randomUUID().toString())
log.info(&quot;resultLineId2-&gt; &quot; + vars.get(&quot;resultLineId2&quot;))

vars.put(&quot;resultLineId3&quot;, UUID.randomUUID().toString())
log.info(&quot;resultLineId3-&gt; &quot; + vars.get(&quot;resultLineId3&quot;))

vars.put(&quot;resultLineId4&quot;, UUID.randomUUID().toString())
log.info(&quot;resultLineId4-&gt; &quot; + vars.get(&quot;resultLineId4&quot;))

vars.put(&quot;resultLineId5&quot;, UUID.randomUUID().toString())
log.info(&quot;resultLineId5-&gt; &quot; + vars.get(&quot;resultLineId5&quot;))

vars.put(&quot;amendmentReasonId1&quot;, UUID.randomUUID().toString())
log.info(&quot;amendmentReasonId1-&gt; &quot; + vars.get(&quot;amendmentReasonId1&quot;))

vars.put(&quot;amendmentReasonId2&quot;, UUID.randomUUID().toString())
log.info(&quot;amendmentReasonId2-&gt; &quot; + vars.get(&quot;amendmentReasonId2&quot;))

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Share Results Reshare" enabled="true">
          <intProp name="HTTPSampler.concurrentPool">6</intProp>
          <stringProp name="HTTPSampler.path">/hearing-service/command/api/rest/hearing/hearings/${hearingId}/share-results</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">${jsonMessage}</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.implementation">HttpClient4</stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">CJSCPPUID</stringProp>
                <stringProp name="Header.value">${userId}</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">application/vnd.hearing.share-results+json</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="ResultShouldPublishDDCHShareResultsResharePreProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">import org.apache.jmeter.engine.util.CompoundVariable
import org.apache.jmeter.util.JMeterUtils;

def dataDir = JMeterUtils.getProperty(&quot;DATA_DIR&quot;)

def file = new File(dataDir, &quot;result-should-publish-ddch-share-results-reshare-request.json&quot;)
if (!file.exists()) {
   throw new FileNotFoundException(&quot;File not found: ${file.absolutePath}&quot;)
}

def rawJson = file.text

vars.put(&quot;resultLineId6&quot;, UUID.randomUUID().toString())
log.info(&quot;resultLineId6-&gt; &quot; + vars.get(&quot;resultLineId6&quot;))

vars.put(&quot;resultLineId7&quot;, UUID.randomUUID().toString())
log.info(&quot;resultLineId7-&gt; &quot; + vars.get(&quot;resultLineId7&quot;))

vars.put(&quot;amendmentReasonId3&quot;, UUID.randomUUID().toString())
log.info(&quot;amendmentReasonId3-&gt; &quot; + vars.get(&quot;amendmentReasonId3&quot;))

vars.put(&quot;amendmentReasonId4&quot;, UUID.randomUUID().toString())
log.info(&quot;amendmentReasonId4-&gt; &quot; + vars.get(&quot;amendmentReasonId4&quot;))

def evaluatedJson = new CompoundVariable(rawJson).execute()

vars.put(&quot;jsonMessage&quot;, evaluatedJson)</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PreProcessor>
          <hashTree/>
        </hashTree>
        <ResultCollector guiclass="SimpleDataWriter" testclass="ResultCollector" testname="Simple Data Writer" enabled="true">
          <boolProp name="ResultCollector.error_logging">false</boolProp>
          <objProp>
            <name>saveConfig</name>
            <value class="SampleSaveConfiguration">
              <time>true</time>
              <latency>true</latency>
              <timestamp>true</timestamp>
              <success>true</success>
              <label>true</label>
              <code>true</code>
              <message>true</message>
              <threadName>true</threadName>
              <dataType>true</dataType>
              <encoding>false</encoding>
              <assertions>true</assertions>
              <subresults>true</subresults>
              <responseData>false</responseData>
              <samplerData>false</samplerData>
              <xml>false</xml>
              <fieldNames>true</fieldNames>
              <responseHeaders>false</responseHeaders>
              <requestHeaders>false</requestHeaders>
              <responseDataOnError>false</responseDataOnError>
              <saveAssertionResultsFailureMessage>true</saveAssertionResultsFailureMessage>
              <assertionsResultsToSave>0</assertionsResultsToSave>
              <bytes>true</bytes>
              <sentBytes>true</sentBytes>
              <url>true</url>
              <threadCounts>true</threadCounts>
              <idleTime>true</idleTime>
              <connectTime>true</connectTime>
            </value>
          </objProp>
          <stringProp name="filename">${resultDir}/ResultShouldPublishDDCHResultsOnInitialShareAndNotForAmendAndReshare.csv</stringProp>
        </ResultCollector>
        <hashTree/>
      </hashTree>
      <ThreadGroup guiclass="ThreadGroupGui" testclass="ThreadGroup" testname="Metrics Collection Thread Group" enabled="true">
        <intProp name="ThreadGroup.num_threads">1</intProp>
        <intProp name="ThreadGroup.ramp_time">1</intProp>
        <boolProp name="ThreadGroup.same_user_on_next_iteration">true</boolProp>
        <stringProp name="ThreadGroup.on_sample_error">continue</stringProp>
        <elementProp name="ThreadGroup.main_controller" elementType="LoopController" guiclass="LoopControlPanel" testclass="LoopController" testname="Loop Controller">
          <intProp name="LoopController.loops">-1</intProp>
          <boolProp name="LoopController.continue_forever">false</boolProp>
        </elementProp>
      </ThreadGroup>
      <hashTree>
        <JDBCSampler guiclass="TestBeanGUI" testclass="JDBCSampler" testname="Get Processed Event Count" enabled="true">
          <stringProp name="dataSource">hearingviewstore</stringProp>
          <stringProp name="query">select count(1) as processed_event_count from processed_event;</stringProp>
          <stringProp name="queryArguments"></stringProp>
          <stringProp name="queryArgumentsTypes"></stringProp>
          <stringProp name="queryTimeout"></stringProp>
          <stringProp name="queryType">Select Statement</stringProp>
          <stringProp name="resultSetHandler">Store as String</stringProp>
          <stringProp name="resultSetMaxRows"></stringProp>
          <stringProp name="resultVariable">processedEventCountResultSet</stringProp>
          <stringProp name="variableNames"></stringProp>
        </JDBCSampler>
        <hashTree>
          <BeanShellAssertion guiclass="BeanShellAssertionGui" testclass="BeanShellAssertion" testname="BeanShell Assertion" enabled="true">
            <stringProp name="BeanShellAssertion.query">vars.put(&quot;prevProcessedEventCount&quot;, org.apache.jmeter.threads.JMeterContextService.getContext().getVariables().get(&quot;processedEventCount&quot;));
org.apache.jmeter.threads.JMeterContextService.getContext().getVariables().put(&quot;processedEventCount&quot;, vars.getObject(&quot;processedEventCountResultSet&quot;).get(0).get(&quot;processed_event_count&quot;).toString())</stringProp>
            <stringProp name="BeanShellAssertion.filename"></stringProp>
            <stringProp name="BeanShellAssertion.parameters"></stringProp>
            <boolProp name="BeanShellAssertion.resetInterpreter">false</boolProp>
          </BeanShellAssertion>
          <hashTree/>
          <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">prev.setIgnore();</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PostProcessor>
          <hashTree/>
        </hashTree>
        <JDBCSampler guiclass="TestBeanGUI" testclass="JDBCSampler" testname="Get Event Log Count" enabled="true">
          <stringProp name="dataSource">hearingeventstore</stringProp>
          <stringProp name="query">select count(1) as event_log_count from event_log;</stringProp>
          <stringProp name="queryArguments"></stringProp>
          <stringProp name="queryArgumentsTypes"></stringProp>
          <stringProp name="queryTimeout"></stringProp>
          <stringProp name="queryType">Select Statement</stringProp>
          <stringProp name="resultSetHandler">Store as String</stringProp>
          <stringProp name="resultSetMaxRows"></stringProp>
          <stringProp name="resultVariable">eventLogCountResultSet</stringProp>
          <stringProp name="variableNames"></stringProp>
        </JDBCSampler>
        <hashTree>
          <BeanShellAssertion guiclass="BeanShellAssertionGui" testclass="BeanShellAssertion" testname="BeanShell Assertion" enabled="true">
            <stringProp name="BeanShellAssertion.query">vars.put(&quot;prevEventLogCount&quot;, org.apache.jmeter.threads.JMeterContextService.getContext().getVariables().get(&quot;eventLogCount&quot;));
org.apache.jmeter.threads.JMeterContextService.getContext().getVariables().put(&quot;eventLogCount&quot;, vars.getObject(&quot;eventLogCountResultSet&quot;).get(0).get(&quot;event_log_count&quot;).toString())</stringProp>
            <stringProp name="BeanShellAssertion.filename"></stringProp>
            <stringProp name="BeanShellAssertion.parameters"></stringProp>
            <boolProp name="BeanShellAssertion.resetInterpreter">false</boolProp>
          </BeanShellAssertion>
          <hashTree/>
          <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">prev.setIgnore();</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PostProcessor>
          <hashTree/>
        </hashTree>
        <JDBCSampler guiclass="TestBeanGUI" testclass="JDBCSampler" testname="Get Published Event Count" enabled="true">
          <stringProp name="dataSource">hearingeventstore</stringProp>
          <stringProp name="query">select count(1) as published_event_count from published_event;</stringProp>
          <stringProp name="queryArguments"></stringProp>
          <stringProp name="queryArgumentsTypes"></stringProp>
          <stringProp name="queryTimeout"></stringProp>
          <stringProp name="queryType">Select Statement</stringProp>
          <stringProp name="resultSetHandler">Store as String</stringProp>
          <stringProp name="resultSetMaxRows"></stringProp>
          <stringProp name="resultVariable">publishedEventCountResultSet</stringProp>
          <stringProp name="variableNames"></stringProp>
        </JDBCSampler>
        <hashTree>
          <BeanShellAssertion guiclass="BeanShellAssertionGui" testclass="BeanShellAssertion" testname="BeanShell Assertion" enabled="true">
            <stringProp name="BeanShellAssertion.query">vars.put(&quot;prevPublishedEventCount&quot;, org.apache.jmeter.threads.JMeterContextService.getContext().getVariables().get(&quot;publishedEventCount&quot;));

org.apache.jmeter.threads.JMeterContextService.getContext().getVariables().put(&quot;publishedEventCount&quot;, vars.getObject(&quot;publishedEventCountResultSet&quot;).get(0).get(&quot;published_event_count&quot;).toString())</stringProp>
            <stringProp name="BeanShellAssertion.filename"></stringProp>
            <stringProp name="BeanShellAssertion.parameters"></stringProp>
            <boolProp name="BeanShellAssertion.resetInterpreter">false</boolProp>
          </BeanShellAssertion>
          <hashTree/>
          <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">prev.setIgnore();</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PostProcessor>
          <hashTree/>
        </hashTree>
        <JSR223Sampler guiclass="TestBeanGUI" testclass="JSR223Sampler" testname="JSR223 Sampler" enabled="true">
          <stringProp name="scriptLanguage">groovy</stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="script">def processedEventCount = org.apache.jmeter.threads.JMeterContextService.getContext().getVariables().get(&quot;processedEventCount&quot;) as long
def eventLogCount = org.apache.jmeter.threads.JMeterContextService.getContext().getVariables().get(&quot;eventLogCount&quot;) as long
def publishedEventCount = org.apache.jmeter.threads.JMeterContextService.getContext().getVariables().get(&quot;publishedEventCount&quot;) as long

if (vars.get(&quot;lastMetricsCollectionTime&quot;) != null) {
	def lastMetricsCollectionTime = vars.get(&quot;lastMetricsCollectionTime&quot;) as long;
	def timeDiff = (System.currentTimeMillis() - lastMetricsCollectionTime)/1000;
	def prevProcessedEventCount = vars.get(&quot;prevProcessedEventCount&quot;) as long;
	def prevEventLogCount = vars.get(&quot;prevEventLogCount&quot;) as long;
	def prevPublishedEventCount = vars.get(&quot;prevPublishedEventCount&quot;) as long;

	def processedEventTps = (processedEventCount - prevProcessedEventCount) / timeDiff;
	def eventLogTps = (eventLogCount - prevEventLogCount) / timeDiff;
	def publishedEventTps = (publishedEventCount - prevPublishedEventCount)/timeDiff;
	println(&quot;processedEventTps: &quot; +  String.format(&quot;%.2f&quot;, processedEventTps) + &quot;, eventLogTps: &quot; +  String.format(&quot;%.2f&quot;, eventLogTps) + &quot;, publishedEventTps: &quot; +  String.format(&quot;%.2f&quot;, publishedEventTps));

}


vars.put(&quot;lastMetricsCollectionTime&quot;, System.currentTimeMillis().toString())
println(&quot;processedEventCount: &quot; + processedEventCount + &quot;, eventLogCount: &quot; + eventLogCount + &quot;, publishedEventCount: &quot; + publishedEventCount);</stringProp>
        </JSR223Sampler>
        <hashTree>
          <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
            <stringProp name="cacheKey">true</stringProp>
            <stringProp name="filename"></stringProp>
            <stringProp name="parameters"></stringProp>
            <stringProp name="script">prev.setIgnore();</stringProp>
            <stringProp name="scriptLanguage">groovy</stringProp>
          </JSR223PostProcessor>
          <hashTree/>
          <ConstantTimer guiclass="ConstantTimerGui" testclass="ConstantTimer" testname="Constant Timer" enabled="true">
            <stringProp name="ConstantTimer.delay">${metricsIntervalInMs}</stringProp>
          </ConstantTimer>
          <hashTree/>
        </hashTree>
        <IfController guiclass="IfControllerPanel" testclass="IfController" testname="Check if the test is completed" enabled="true">
          <stringProp name="IfController.condition">${__groovy((org.apache.jmeter.threads.JMeterContextService.getThreadCounts().activeThreads == 1 &amp;&amp; vars.getIteration() &gt; 1),)}</stringProp>
          <boolProp name="IfController.evaluateAll">false</boolProp>
          <boolProp name="IfController.useExpression">true</boolProp>
        </IfController>
        <hashTree>
          <TestAction guiclass="TestActionGui" testclass="TestAction" testname="Terminate current thread" enabled="true">
            <intProp name="ActionProcessor.action">2</intProp>
            <intProp name="ActionProcessor.target">0</intProp>
            <stringProp name="ActionProcessor.duration">0</stringProp>
          </TestAction>
          <hashTree/>
        </hashTree>
        <ResultCollector guiclass="SimpleDataWriter" testclass="ResultCollector" testname="Simple Data Writer" enabled="true">
          <boolProp name="ResultCollector.error_logging">false</boolProp>
          <objProp>
            <name>saveConfig</name>
            <value class="SampleSaveConfiguration">
              <time>true</time>
              <latency>true</latency>
              <timestamp>true</timestamp>
              <success>true</success>
              <label>true</label>
              <code>true</code>
              <message>true</message>
              <threadName>true</threadName>
              <dataType>true</dataType>
              <encoding>false</encoding>
              <assertions>true</assertions>
              <subresults>true</subresults>
              <responseData>false</responseData>
              <samplerData>false</samplerData>
              <xml>false</xml>
              <fieldNames>true</fieldNames>
              <responseHeaders>false</responseHeaders>
              <requestHeaders>false</requestHeaders>
              <responseDataOnError>false</responseDataOnError>
              <saveAssertionResultsFailureMessage>true</saveAssertionResultsFailureMessage>
              <assertionsResultsToSave>0</assertionsResultsToSave>
              <bytes>true</bytes>
              <sentBytes>true</sentBytes>
              <url>true</url>
              <threadCounts>true</threadCounts>
              <idleTime>true</idleTime>
              <connectTime>true</connectTime>
            </value>
          </objProp>
          <stringProp name="filename">${resultDir}/custom-metrics.csv</stringProp>
        </ResultCollector>
        <hashTree/>
      </hashTree>
    </hashTree>
  </hashTree>
</jmeterTestPlan>
